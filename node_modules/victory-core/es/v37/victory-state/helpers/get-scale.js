var _excluded = ["data"];

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

import { scaleLinear, scaleTime, scaleLog, scaleSqrt } from "victory-vendor/d3-scale";
import * as Collection from "../../../victory-util/collection";
import { getValueForAxis, isFunction } from "../../../victory-util/type-helpers";
import { getAxisData } from "./get-axis-data";
var DEFAULT_SCALE = scaleLinear;

function isD3Scale(scale) {
  return isFunction(scale) && isFunction(scale().copy) && isFunction(scale().domain) && isFunction(scale().range);
}

function getD3ScaleFromString(scale) {
  switch (scale) {
    case "linear":
      return scaleLinear;

    case "time":
      return scaleTime;

    case "log":
      return scaleLog;

    case "sqrt":
      return scaleSqrt;

    default:
      return DEFAULT_SCALE;
  }
}

export function getScale(_ref, axis) {
  var _ref$data = _ref.data,
      data = _ref$data === void 0 ? [] : _ref$data,
      props = _objectWithoutProperties(_ref, _excluded);

  var scale = getValueForAxis(props.scale, axis);

  if (isD3Scale(scale)) {
    return scale;
  }

  if (typeof scale === "string") {
    return getD3ScaleFromString(scale);
  }

  var axisData = getAxisData(data, axis);

  if (Collection.containsDates(axisData)) {
    return scaleTime;
  }

  return DEFAULT_SCALE;
}